{% extends "layouts/base.html" %}

{% block title %} Final Analyze {% endblock %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
{% block content %}
<div class="pcoded-main-container">
    <div class="pcoded-content">
        <!-- [ breadcrumb ] start -->
        <div class="page-header">
            <div class="page-block">
                <div class="row align-items-center">
                    <div class="col-md-12">
                        <div class="page-header-title">
                            <h5 class="m-b-10">최종 필터링 결과</h5>
                        </div>
                        <ul class="breadcrumb">
                            <li class="breadcrumb-item"><a href="/"><i class="feather icon-home"></i></a></li>
                            <li class="breadcrumb-item"><a href="#">Case</a></li>
                            <li class="breadcrumb-item"><a href="#">Analyze</a></li>
                            <li class="breadcrumb-item"><a href="#">Filtering</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <!-- [ breadcrumb ] end -->
        <!-- [ Main Content ] start -->
        
        
        <div class="row">
            <div class="col-sm-12">
                <div class="card">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>파일 이름</th>
                                <th>타임라인</th>
                                <th>사용 브라우저</th>
                                <th>파일 설명</th>
                                <th>커넥션</th>
                                <th>TTPs</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for result in malware_data.results %}
                                <tr>
                                    <td>{{loop.index}}</td>
                                    <td>{{result.Filename}}</td>
                                    <td>
                                        <p>{{result.Timeline.split('~')[0]}}</p>
                                        <p>~</p>
                                        <p>{{result.Timeline.split('~')[1]}}</p>
                                    </td>
                                    <td>{{result.Browser}}</td>
                                    <td>
                                        {% for description in result.Description %}
                                            <p>{{description}}</p>
                                        {% endfor %}
                                    </td>
                                    <td><button class="btn btn-primary">커넥션</button></td>
                                    <td>
                                        {% for ttp in result.TTPs %}
                                            <p>{{ttp}}</p>
                                        {% endfor %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                
            </div>
        </div>
        <!-- [ Main Content ] end -->
    </div>
</div>

<div id="tooltip" style="display: none; position: absolute;
    background-color: white;
    border: 1px solid black;
    padding: 5px;
    border-radius: 3px;
    z-index: 1200;
    pointer-events: none;"></div>

<!-- 모달 -->
<div class="modal fade" id="detailModal" tabindex="-1" aria-labelledby="DetailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="DetailModalLabel">행위 흐름 그래프</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" style="overflow-y: auto;">
                <div id="modalDetail"></div>
                <div id="modalDetail-filename"></div>
                <div id="network_graph"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
            </div>
        </div>
    </div>
</div>

<!-- jQuery와 Bootstrap JS 추가 (head 또는 body 끝부분에) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>


{% endblock content %}

{% block javascripts %}
{% endblock javascripts %}
